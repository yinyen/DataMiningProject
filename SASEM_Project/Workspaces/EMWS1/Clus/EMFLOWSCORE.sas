*****************************************;
*** Begin Scoring Code from PROC DMVQ ***;
*****************************************;


*** Begin Class Look-up, Standardization, Replacement ;
drop _dm_bad; _dm_bad = 0;

*** Standardize IMP_domestic_gross ;
drop T_IMP_domestic_gross ;
if missing( IMP_domestic_gross ) then T_IMP_domestic_gross = .;
else T_IMP_domestic_gross = (IMP_domestic_gross
         - 18139990.4321365) * 1.7668527225304E-8;

*** Standardize IMP_domestic_opening ;
drop T_IMP_domestic_opening ;
if missing( IMP_domestic_opening ) then T_IMP_domestic_opening = .;
else T_IMP_domestic_opening = (IMP_domestic_opening
         - 4927103.23613213) * 5.7716376501924E-8;

*** Standardize IMP_foreign_gross ;
drop T_IMP_foreign_gross ;
if missing( IMP_foreign_gross ) then T_IMP_foreign_gross = .;
else T_IMP_foreign_gross = (IMP_foreign_gross
         - 27897016.0534439) * 1.0317252291005E-8;

*** Standardize IMP_runtime ;
drop T_IMP_runtime ;
if missing( IMP_runtime ) then T_IMP_runtime = .;
else T_IMP_runtime = (IMP_runtime - 99.8267786891675) * 0.05343192168381;

*** Standardize IMP_ss_count ;
drop T_IMP_ss_count ;
if missing( IMP_ss_count ) then T_IMP_ss_count = .;
else T_IMP_ss_count = (IMP_ss_count - 67.1739334894049) * 0.01191492712449;

*** Standardize IMP_ss_mean ;
drop T_IMP_ss_mean ;
if missing( IMP_ss_mean ) then T_IMP_ss_mean = .;
else T_IMP_ss_mean = (IMP_ss_mean - 0.70179955655744) * 5.73003032641675;

*** Standardize IMP_ss_median ;
drop T_IMP_ss_median ;
if missing( IMP_ss_median ) then T_IMP_ss_median = .;
else T_IMP_ss_median = (IMP_ss_median - 0.8623872026251) * 2.99006100300255;

*** Standardize IMP_ss_p25 ;
drop T_IMP_ss_p25 ;
if missing( IMP_ss_p25 ) then T_IMP_ss_p25 = .;
else T_IMP_ss_p25 = (IMP_ss_p25 - 0.4891304347826) * 2.06755567159764;

*** Standardize IMP_ss_p75 ;
drop T_IMP_ss_p75 ;
if missing( IMP_ss_p75 ) then T_IMP_ss_p75 = .;
else T_IMP_ss_p75 = (IMP_ss_p75 - 0.98297785069729) * 8.39931922170729;

*** Standardize IMP_ss_std ;
drop T_IMP_ss_std ;
if missing( IMP_ss_std ) then T_IMP_ss_std = .;
else T_IMP_ss_std = (IMP_ss_std - 0.42246050415712) * 9.26088286563927;

*** Standardize IMP_total_gross ;
drop T_IMP_total_gross ;
if missing( IMP_total_gross ) then T_IMP_total_gross = .;
else T_IMP_total_gross = (IMP_total_gross
         - 46074314.9107817) * 6.7135364800612E-9;

*** Standardize IMP_user_rating_count ;
drop T_IMP_user_rating_count ;
if missing( IMP_user_rating_count ) then T_IMP_user_rating_count = .;
else T_IMP_user_rating_count = (IMP_user_rating_count
         - 10702.487861413) * 0.00002943008321;

*** Standardize tomatometer_count ;
drop T_tomatometer_count ;
if missing( tomatometer_count ) then T_tomatometer_count = .;
else T_tomatometer_count = (tomatometer_count
         - 67.2916324856439) * 0.01189813583304;

*** Generate dummy variables for G ;
drop G0 G1 ;
if missing( G ) then do;
   G0 = .;
   G1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( G , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      G0 = 0.06589724197767;
      G1 = -0.06589724197767;
   end;
   else if _dm12 = '1'  then do;
      G0 = -7.58445875524059;
      G1 = 7.58445875524059;
   end;
   else do;
      G0 = .;
      G1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for IMP_markets_missing ;
drop IMP_markets_missing0 IMP_markets_missing1 ;
if missing( IMP_markets_missing ) then do;
   IMP_markets_missing0 = .;
   IMP_markets_missing1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( IMP_markets_missing , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '1'  then do;
      IMP_markets_missing0 = -0.6021251505239;
      IMP_markets_missing1 = 0.6021251505239;
   end;
   else if _dm12 = '0'  then do;
      IMP_markets_missing0 = 0.83005154896612;
      IMP_markets_missing1 = -0.83005154896612;
   end;
   else do;
      IMP_markets_missing0 = .;
      IMP_markets_missing1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for NR ;
drop NR0 NR1 ;
if missing( NR ) then do;
   NR0 = .;
   NR1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( NR , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      NR0 = 0.64580172202059;
      NR1 = -0.64580172202059;
   end;
   else if _dm12 = '1'  then do;
      NR0 = -0.77391387607337;
      NR1 = 0.77391387607337;
   end;
   else do;
      NR0 = .;
      NR1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for PG ;
drop PG0 PG1 ;
if missing( PG ) then do;
   PG0 = .;
   PG1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( PG , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      PG0 = 0.18484188776315;
      PG1 = -0.18484188776315;
   end;
   else if _dm12 = '1'  then do;
      PG0 = -2.70390505048413;
      PG1 = 2.70390505048413;
   end;
   else do;
      PG0 = .;
      PG1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for PG_13 ;
drop PG_130 PG_131 ;
if missing( PG_13 ) then do;
   PG_130 = .;
   PG_131 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( PG_13 , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      PG_130 = 0.3052034158813;
      PG_131 = -0.3052034158813;
   end;
   else if _dm12 = '1'  then do;
      PG_130 = -1.6375796857339;
      PG_131 = 1.6375796857339;
   end;
   else do;
      PG_130 = .;
      PG_131 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for R ;
drop R0 R1 ;
if missing( R ) then do;
   R0 = .;
   R1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( R , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      R0 = 0.4798780856518;
      R1 = -0.4798780856518;
   end;
   else if _dm12 = '1'  then do;
      R0 = -1.04150393361881;
      R1 = 1.04150393361881;
   end;
   else do;
      R0 = .;
      R1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Action ;
drop genre_Action0 genre_Action1 ;
if missing( genre_Action ) then do;
   genre_Action0 = .;
   genre_Action1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Action , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Action0 = 0.31273302886431;
      genre_Action1 = -0.31273302886431;
   end;
   else if _dm12 = '1'  then do;
      genre_Action0 = -1.59815199462242;
      genre_Action1 = 1.59815199462242;
   end;
   else do;
      genre_Action0 = .;
      genre_Action1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Adventure ;
drop genre_Adventure0 genre_Adventure1 ;
if missing( genre_Adventure ) then do;
   genre_Adventure0 = .;
   genre_Adventure1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Adventure , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Adventure0 = 0.31179537379821;
      genre_Adventure1 = -0.31179537379821;
   end;
   else if _dm12 = '1'  then do;
      genre_Adventure0 = -1.60295808040845;
      genre_Adventure1 = 1.60295808040845;
   end;
   else do;
      genre_Adventure0 = .;
      genre_Adventure1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_AnimationManga ;
drop genre_AnimationManga0 genre_AnimationManga1 ;
if missing( genre_AnimationManga ) then do;
   genre_AnimationManga0 = .;
   genre_AnimationManga1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_AnimationManga , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_AnimationManga0 = 0.13599696856867;
      genre_AnimationManga1 = -0.13599696856867;
   end;
   else if _dm12 = '1'  then do;
      genre_AnimationManga0 = -3.67504451844776;
      genre_AnimationManga1 = 3.67504451844776;
   end;
   else do;
      genre_AnimationManga0 = .;
      genre_AnimationManga1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_ArthouseInter ;
drop genre_ArthouseInter0 genre_ArthouseInter1 ;
if missing( genre_ArthouseInter ) then do;
   genre_ArthouseInter0 = .;
   genre_ArthouseInter1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_ArthouseInter , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_ArthouseInter0 = 0.24583525213778;
      genre_ArthouseInter1 = -0.24583525213778;
   end;
   else if _dm12 = '1'  then do;
      genre_ArthouseInter0 = -2.03304818783149;
      genre_ArthouseInter1 = 2.03304818783149;
   end;
   else do;
      genre_ArthouseInter0 = .;
      genre_ArthouseInter1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_ClassicsCult ;
drop genre_ClassicsCult0 genre_ClassicsCult1 ;
if missing( genre_ClassicsCult ) then do;
   genre_ClassicsCult0 = .;
   genre_ClassicsCult1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_ClassicsCult , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_ClassicsCult0 = 0.05924108200796;
      genre_ClassicsCult1 = -0.05924108200796;
   end;
   else if _dm12 = '1'  then do;
      genre_ClassicsCult0 = -8.43662703183988;
      genre_ClassicsCult1 = 8.43662703183988;
   end;
   else do;
      genre_ClassicsCult0 = .;
      genre_ClassicsCult1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Comedy ;
drop genre_Comedy0 genre_Comedy1 ;
if missing( genre_Comedy ) then do;
   genre_Comedy0 = .;
   genre_Comedy1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Comedy , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Comedy0 = 0.40526261076474;
      genre_Comedy1 = -0.40526261076474;
   end;
   else if _dm12 = '1'  then do;
      genre_Comedy0 = -1.2332618420453;
      genre_Comedy1 = 1.2332618420453;
   end;
   else do;
      genre_Comedy0 = .;
      genre_Comedy1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_DramaTele ;
drop genre_DramaTele0 genre_DramaTele1 ;
if missing( genre_DramaTele ) then do;
   genre_DramaTele0 = .;
   genre_DramaTele1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_DramaTele , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_DramaTele0 = 0.70291367250716;
      genre_DramaTele1 = -0.70291367250716;
   end;
   else if _dm12 = '1'  then do;
      genre_DramaTele0 = -0.71103313737111;
      genre_DramaTele1 = 0.71103313737111;
   end;
   else do;
      genre_DramaTele0 = .;
      genre_DramaTele1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_FamilyKids ;
drop genre_FamilyKids0 genre_FamilyKids1 ;
if missing( genre_FamilyKids ) then do;
   genre_FamilyKids0 = .;
   genre_FamilyKids1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_FamilyKids , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_FamilyKids0 = 0.13518437049945;
      genre_FamilyKids1 = -0.13518437049945;
   end;
   else if _dm12 = '1'  then do;
      genre_FamilyKids0 = -3.69713534203158;
      genre_FamilyKids1 = 3.69713534203158;
   end;
   else do;
      genre_FamilyKids0 = .;
      genre_FamilyKids1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Fantasy ;
drop genre_Fantasy0 genre_Fantasy1 ;
if missing( genre_Fantasy ) then do;
   genre_Fantasy0 = .;
   genre_Fantasy1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Fantasy , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Fantasy0 = 0.21420444815115;
      genre_Fantasy1 = -0.21420444815115;
   end;
   else if _dm12 = '1'  then do;
      genre_Fantasy0 = -2.33326113522695;
      genre_Fantasy1 = 2.33326113522695;
   end;
   else do;
      genre_Fantasy0 = .;
      genre_Fantasy1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_FitnessSports ;
drop genre_FitnessSports0 genre_FitnessSports1 ;
if missing( genre_FitnessSports ) then do;
   genre_FitnessSports0 = .;
   genre_FitnessSports1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_FitnessSports , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_FitnessSports0 = 0.06746193464646;
      genre_FitnessSports1 = -0.06746193464646;
   end;
   else if _dm12 = '1'  then do;
      genre_FitnessSports0 = -7.40854700481139;
      genre_FitnessSports1 = 7.40854700481139;
   end;
   else do;
      genre_FitnessSports0 = .;
      genre_FitnessSports1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_HistDocument ;
drop genre_HistDocument0 genre_HistDocument1 ;
if missing( genre_HistDocument ) then do;
   genre_HistDocument0 = .;
   genre_HistDocument1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_HistDocument , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_HistDocument0 = 0.31132617810331;
      genre_HistDocument1 = -0.31132617810331;
   end;
   else if _dm12 = '1'  then do;
      genre_HistDocument0 = -1.60537387799739;
      genre_HistDocument1 = 1.60537387799739;
   end;
   else do;
      genre_HistDocument0 = .;
      genre_HistDocument1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Horror ;
drop genre_Horror0 genre_Horror1 ;
if missing( genre_Horror ) then do;
   genre_Horror0 = .;
   genre_Horror1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Horror , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Horror0 = 0.24215225943668;
      genre_Horror1 = -0.24215225943668;
   end;
   else if _dm12 = '1'  then do;
      genre_Horror0 = -2.06396964879238;
      genre_Horror1 = 2.06396964879238;
   end;
   else do;
      genre_Horror0 = .;
      genre_Horror1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_MusicalPerfarts ;
drop genre_MusicalPerfarts0 genre_MusicalPerfarts1 ;
if missing( genre_MusicalPerfarts ) then do;
   genre_MusicalPerfarts0 = .;
   genre_MusicalPerfarts1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_MusicalPerfarts , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_MusicalPerfarts0 = 0.12594898936491;
      genre_MusicalPerfarts1 = -0.12594898936491;
   end;
   else if _dm12 = '1'  then do;
      genre_MusicalPerfarts0 = -3.96823282492381;
      genre_MusicalPerfarts1 = 3.96823282492381;
   end;
   else do;
      genre_MusicalPerfarts0 = .;
      genre_MusicalPerfarts1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Romance ;
drop genre_Romance0 genre_Romance1 ;
if missing( genre_Romance ) then do;
   genre_Romance0 = .;
   genre_Romance1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Romance , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Romance0 = 0.19171036082114;
      genre_Romance1 = -0.19171036082114;
   end;
   else if _dm12 = '1'  then do;
      genre_Romance0 = -2.60703131392105;
      genre_Romance1 = 2.60703131392105;
   end;
   else do;
      genre_Romance0 = .;
      genre_Romance1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Sci_fi ;
drop genre_Sci_fi0 genre_Sci_fi1 ;
if missing( genre_Sci_fi ) then do;
   genre_Sci_fi0 = .;
   genre_Sci_fi1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Sci_fi , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Sci_fi0 = 0.21363352939747;
      genre_Sci_fi1 = -0.21363352939747;
   end;
   else if _dm12 = '1'  then do;
      genre_Sci_fi0 = -2.33949659153896;
      genre_Sci_fi1 = 2.33949659153896;
   end;
   else do;
      genre_Sci_fi0 = .;
      genre_Sci_fi1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Special_Interest ;
drop genre_Special_Interest0 genre_Special_Interest1 ;
if missing( genre_Special_Interest ) then do;
   genre_Special_Interest0 = .;
   genre_Special_Interest1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Special_Interest , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Special_Interest0 = 0.20079923895056;
      genre_Special_Interest1 = -0.20079923895056;
   end;
   else if _dm12 = '1'  then do;
      genre_Special_Interest0 = -2.48902792896968;
      genre_Special_Interest1 = 2.48902792896968;
   end;
   else do;
      genre_Special_Interest0 = .;
      genre_Special_Interest1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_ThrillMysSusp ;
drop genre_ThrillMysSusp0 genre_ThrillMysSusp1 ;
if missing( genre_ThrillMysSusp ) then do;
   genre_ThrillMysSusp0 = .;
   genre_ThrillMysSusp1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_ThrillMysSusp , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_ThrillMysSusp0 = 0.3225224724024;
      genre_ThrillMysSusp1 = -0.3225224724024;
   end;
   else if _dm12 = '1'  then do;
      genre_ThrillMysSusp0 = -1.54964368882871;
      genre_ThrillMysSusp1 = 1.54964368882871;
   end;
   else do;
      genre_ThrillMysSusp0 = .;
      genre_ThrillMysSusp1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for genre_Western ;
drop genre_Western0 genre_Western1 ;
if missing( genre_Western ) then do;
   genre_Western0 = .;
   genre_Western1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( genre_Western , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      genre_Western0 = 0.0574604255507;
      genre_Western1 = -0.0574604255507;
   end;
   else if _dm12 = '1'  then do;
      genre_Western0 = -8.69807191773764;
      genre_Western1 = 8.69807191773764;
   end;
   else do;
      genre_Western0 = .;
      genre_Western1 = .;
      _DM_BAD = 1;
   end;
end;

*** End Class Look-up, Standardization, Replacement ;


*** Omitted Cases;
if _dm_bad then do;
   _SEGMENT_ = .; Distance = .;
   goto CLUSvlex ;
end; *** omitted;

*** Compute Distances and Cluster Membership;
label _SEGMENT_ = 'Segment Id' ;
label Distance = 'Distance' ;
array CLUSvads [3] _temporary_;
drop _vqclus _vqmvar _vqnvar;
_vqmvar = 0;
do _vqclus = 1 to 3; CLUSvads [_vqclus] = 0; end;
if not missing( T_IMP_domestic_gross ) then do;
   CLUSvads [1] + ( T_IMP_domestic_gross - -0.31797130137589 )**2;
   CLUSvads [2] + ( T_IMP_domestic_gross - 2.87220794248178 )**2;
   CLUSvads [3] + ( T_IMP_domestic_gross - -0.18958242695248 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_domestic_opening ) then do;
   CLUSvads [1] + ( T_IMP_domestic_opening - -0.28354222538785 )**2;
   CLUSvads [2] + ( T_IMP_domestic_opening - 2.73482456067058 )**2;
   CLUSvads [3] + ( T_IMP_domestic_opening - -0.18052273247413 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_foreign_gross ) then do;
   CLUSvads [1] + ( T_IMP_foreign_gross - -0.28665797068269 )**2;
   CLUSvads [2] + ( T_IMP_foreign_gross - 2.94640159873994 )**2;
   CLUSvads [3] + ( T_IMP_foreign_gross - -0.19449693063825 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_runtime ) then do;
   CLUSvads [1] + ( T_IMP_runtime - 20.3133857873635 )**2;
   CLUSvads [2] + ( T_IMP_runtime - 0.76006399735459 )**2;
   CLUSvads [3] + ( T_IMP_runtime - -0.05909144767625 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_count ) then do;
   CLUSvads [1] + ( T_IMP_ss_count - -0.72888295944489 )**2;
   CLUSvads [2] + ( T_IMP_ss_count - 2.08974692011831 )**2;
   CLUSvads [3] + ( T_IMP_ss_count - -0.13771780488994 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_mean ) then do;
   CLUSvads [1] + ( T_IMP_ss_mean - -1.15631757893163 )**2;
   CLUSvads [2] + ( T_IMP_ss_mean - 0.00219753251188 )**2;
   CLUSvads [3] + ( T_IMP_ss_mean - 0.00036066936555 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_median ) then do;
   CLUSvads [1] + ( T_IMP_ss_median - -1.0835598425565 )**2;
   CLUSvads [2] + ( T_IMP_ss_median - 0.08474213874912 )**2;
   CLUSvads [3] + ( T_IMP_ss_median - -0.00512357966253 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_p25 ) then do;
   CLUSvads [1] + ( T_IMP_ss_p25 - -1.0113044045858 )**2;
   CLUSvads [2] + ( T_IMP_ss_p25 - -0.10760457461597 )**2;
   CLUSvads [3] + ( T_IMP_ss_p25 - 0.00755012912143 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_p75 ) then do;
   CLUSvads [1] + ( T_IMP_ss_p75 - 0.14297446583299 )**2;
   CLUSvads [2] + ( T_IMP_ss_p75 - 0.08734983522566 )**2;
   CLUSvads [3] + ( T_IMP_ss_p75 - -0.00583237077205 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_ss_std ) then do;
   CLUSvads [1] + ( T_IMP_ss_std - 1.16003720356567 )**2;
   CLUSvads [2] + ( T_IMP_ss_std - 0.06803752640285 )**2;
   CLUSvads [3] + ( T_IMP_ss_std - -0.00500162016202 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_total_gross ) then do;
   CLUSvads [1] + ( T_IMP_total_gross - -0.30568052081813 )**2;
   CLUSvads [2] + ( T_IMP_total_gross - 3.00835883460645 )**2;
   CLUSvads [3] + ( T_IMP_total_gross - -0.19858114763987 )**2;
end;
else _vqmvar + 1;
if not missing( T_IMP_user_rating_count ) then do;
   CLUSvads [1] + ( T_IMP_user_rating_count - -0.28360263966671 )**2;
   CLUSvads [2] + ( T_IMP_user_rating_count - 2.28535453929982 )**2;
   CLUSvads [3] + ( T_IMP_user_rating_count - -0.15083330393464 )**2;
end;
else _vqmvar + 1;
if not missing( T_tomatometer_count ) then do;
   CLUSvads [1] + ( T_tomatometer_count - -0.7292561687433 )**2;
   CLUSvads [2] + ( T_tomatometer_count - 2.08540151398664 )**2;
   CLUSvads [3] + ( T_tomatometer_count - -0.13743060911777 )**2;
end;
else _vqmvar + 1;
if not missing( G0 ) then do;
   CLUSvads [1] + ( G0 - 0.06589724197767 )**2;
   CLUSvads [2] + ( G0 - -0.03543197652852 )**2;
   CLUSvads [3] + ( G0 - 0.0023116059553 )**2;
end;
else _vqmvar + 0.5;
if not missing( G1 ) then do;
   CLUSvads [1] + ( G1 - -0.06589724197767 )**2;
   CLUSvads [2] + ( G1 - 0.03543197652852 )**2;
   CLUSvads [3] + ( G1 - -0.0023116059553 )**2;
end;
else _vqmvar + 0.5;
if not missing( IMP_markets_missing0 ) then do;
   CLUSvads [1] + ( IMP_markets_missing0 - -0.6021251505239 )**2;
   CLUSvads [2] + ( IMP_markets_missing0 - 0.79211309335049 )**2;
   CLUSvads [3] + ( IMP_markets_missing0 - -0.05205903409685 )**2;
end;
else _vqmvar + 0.5;
if not missing( IMP_markets_missing1 ) then do;
   CLUSvads [1] + ( IMP_markets_missing1 - 0.6021251505239 )**2;
   CLUSvads [2] + ( IMP_markets_missing1 - -0.79211309335049 )**2;
   CLUSvads [3] + ( IMP_markets_missing1 - 0.05205903409685 )**2;
end;
else _vqmvar + 0.5;
if not missing( NR0 ) then do;
   CLUSvads [1] + ( NR0 - -0.77391387607337 )**2;
   CLUSvads [2] + ( NR0 - 0.57998709164538 )**2;
   CLUSvads [3] + ( NR0 - -0.03797206341311 )**2;
end;
else _vqmvar + 0.5;
if not missing( NR1 ) then do;
   CLUSvads [1] + ( NR1 - 0.77391387607337 )**2;
   CLUSvads [2] + ( NR1 - -0.57998709164538 )**2;
   CLUSvads [3] + ( NR1 - 0.03797206341311 )**2;
end;
else _vqmvar + 0.5;
if not missing( PG0 ) then do;
   CLUSvads [1] + ( PG0 - 0.18484188776315 )**2;
   CLUSvads [2] + ( PG0 - -0.61865063810695 )**2;
   CLUSvads [3] + ( PG0 - 0.04078364149885 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( PG1 ) then do;
   CLUSvads [1] + ( PG1 - -0.18484188776315 )**2;
   CLUSvads [2] + ( PG1 - 0.61865063810695 )**2;
   CLUSvads [3] + ( PG1 - -0.04078364149885 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( PG_130 ) then do;
   CLUSvads [1] + ( PG_130 - 0.3052034158813 )**2;
   CLUSvads [2] + ( PG_130 - -0.62115673853124 )**2;
   CLUSvads [3] + ( PG_130 - 0.04089652847871 )**2;
end;
else _vqmvar + 0.5;
if not missing( PG_131 ) then do;
   CLUSvads [1] + ( PG_131 - -0.3052034158813 )**2;
   CLUSvads [2] + ( PG_131 - 0.62115673853124 )**2;
   CLUSvads [3] + ( PG_131 - -0.04089652847871 )**2;
end;
else _vqmvar + 0.5;
if not missing( R0 ) then do;
   CLUSvads [1] + ( R0 - 0.4798780856518 )**2;
   CLUSvads [2] + ( R0 - 0.19776751254202 )**2;
   CLUSvads [3] + ( R0 - -0.0132733037968 )**2;
end;
else _vqmvar + 0.5;
if not missing( R1 ) then do;
   CLUSvads [1] + ( R1 - -0.4798780856518 )**2;
   CLUSvads [2] + ( R1 - -0.19776751254202 )**2;
   CLUSvads [3] + ( R1 - 0.0132733037968 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Action0 ) then do;
   CLUSvads [1] + ( genre_Action0 - 0.31273302886431 )**2;
   CLUSvads [2] + ( genre_Action0 - -0.80089532919418 )**2;
   CLUSvads [3] + ( genre_Action0 - 0.05276573126835 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( genre_Action1 ) then do;
   CLUSvads [1] + ( genre_Action1 - -0.31273302886431 )**2;
   CLUSvads [2] + ( genre_Action1 - 0.80089532919418 )**2;
   CLUSvads [3] + ( genre_Action1 - -0.05276573126835 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( genre_Adventure0 ) then do;
   CLUSvads [1] + ( genre_Adventure0 - 0.31179537379821 )**2;
   CLUSvads [2] + ( genre_Adventure0 - -0.80408743395136 )**2;
   CLUSvads [3] + ( genre_Adventure0 - 0.05297699350518 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Adventure1 ) then do;
   CLUSvads [1] + ( genre_Adventure1 - -0.31179537379821 )**2;
   CLUSvads [2] + ( genre_Adventure1 - 0.80408743395136 )**2;
   CLUSvads [3] + ( genre_Adventure1 - -0.05297699350518 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_AnimationManga0 ) then do;
   CLUSvads [1] + ( genre_AnimationManga0 - 0.13599696856867 )**2;
   CLUSvads [2] + ( genre_AnimationManga0 - -0.67164096245467 )**2;
   CLUSvads [3] + ( genre_AnimationManga0 - 0.04430524425288 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_AnimationManga1 ) then do;
   CLUSvads [1] + ( genre_AnimationManga1 - -0.13599696856867 )**2;
   CLUSvads [2] + ( genre_AnimationManga1 - 0.67164096245467 )**2;
   CLUSvads [3] + ( genre_AnimationManga1 - -0.04430524425288 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ArthouseInter0 ) then do;
   CLUSvads [1] + ( genre_ArthouseInter0 - 0.24583525213778 )**2;
   CLUSvads [2] + ( genre_ArthouseInter0 - 0.20055942220462 )**2;
   CLUSvads [3] + ( genre_ArthouseInter0 - -0.01335534033466 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ArthouseInter1 ) then do;
   CLUSvads [1] + ( genre_ArthouseInter1 - -0.24583525213778 )**2;
   CLUSvads [2] + ( genre_ArthouseInter1 - -0.20055942220462 )**2;
   CLUSvads [3] + ( genre_ArthouseInter1 - 0.01335534033466 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ClassicsCult0 ) then do;
   CLUSvads [1] + ( genre_ClassicsCult0 - 0.05924108200796 )**2;
   CLUSvads [2] + ( genre_ClassicsCult0 - 0.05924108200796 )**2;
   CLUSvads [3] + ( genre_ClassicsCult0 - -0.00393903957358 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ClassicsCult1 ) then do;
   CLUSvads [1] + ( genre_ClassicsCult1 - -0.05924108200796 )**2;
   CLUSvads [2] + ( genre_ClassicsCult1 - -0.05924108200796 )**2;
   CLUSvads [3] + ( genre_ClassicsCult1 - 0.00393903957358 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Comedy0 ) then do;
   CLUSvads [1] + ( genre_Comedy0 - 0.40526261076474 )**2;
   CLUSvads [2] + ( genre_Comedy0 - -0.06133706785003 )**2;
   CLUSvads [3] + ( genre_Comedy0 - 0.00387429336596 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Comedy1 ) then do;
   CLUSvads [1] + ( genre_Comedy1 - -0.40526261076474 )**2;
   CLUSvads [2] + ( genre_Comedy1 - 0.06133706785003 )**2;
   CLUSvads [3] + ( genre_Comedy1 - -0.00387429336596 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_DramaTele0 ) then do;
   CLUSvads [1] + ( genre_DramaTele0 - -0.71103313737111 )**2;
   CLUSvads [2] + ( genre_DramaTele0 - 0.21599159228418 )**2;
   CLUSvads [3] + ( genre_DramaTele0 - -0.01395612305229 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_DramaTele1 ) then do;
   CLUSvads [1] + ( genre_DramaTele1 - 0.71103313737111 )**2;
   CLUSvads [2] + ( genre_DramaTele1 - -0.21599159228418 )**2;
   CLUSvads [3] + ( genre_DramaTele1 - 0.01395612305229 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_FamilyKids0 ) then do;
   CLUSvads [1] + ( genre_FamilyKids0 - 0.13518437049945 )**2;
   CLUSvads [2] + ( genre_FamilyKids0 - -0.72772205483865 )**2;
   CLUSvads [3] + ( genre_FamilyKids0 - 0.04800999383645 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_FamilyKids1 ) then do;
   CLUSvads [1] + ( genre_FamilyKids1 - -0.13518437049945 )**2;
   CLUSvads [2] + ( genre_FamilyKids1 - 0.72772205483865 )**2;
   CLUSvads [3] + ( genre_FamilyKids1 - -0.04800999383645 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Fantasy0 ) then do;
   CLUSvads [1] + ( genre_Fantasy0 - 0.21420444815115 )**2;
   CLUSvads [2] + ( genre_Fantasy0 - -0.89925733001411 )**2;
   CLUSvads [3] + ( genre_Fantasy0 - 0.05930605966053 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Fantasy1 ) then do;
   CLUSvads [1] + ( genre_Fantasy1 - -0.21420444815115 )**2;
   CLUSvads [2] + ( genre_Fantasy1 - 0.89925733001411 )**2;
   CLUSvads [3] + ( genre_Fantasy1 - -0.05930605966053 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_FitnessSports0 ) then do;
   CLUSvads [1] + ( genre_FitnessSports0 - 0.06746193464646 )**2;
   CLUSvads [2] + ( genre_FitnessSports0 - 0.06746193464646 )**2;
   CLUSvads [3] + ( genre_FitnessSports0 - -0.00448565794674 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_FitnessSports1 ) then do;
   CLUSvads [1] + ( genre_FitnessSports1 - -0.06746193464646 )**2;
   CLUSvads [2] + ( genre_FitnessSports1 - -0.06746193464646 )**2;
   CLUSvads [3] + ( genre_FitnessSports1 - 0.00448565794674 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_HistDocument0 ) then do;
   CLUSvads [1] + ( genre_HistDocument0 - -1.60537387799739 )**2;
   CLUSvads [2] + ( genre_HistDocument0 - 0.31132617810331 )**2;
   CLUSvads [3] + ( genre_HistDocument0 - -0.01986215180035 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_HistDocument1 ) then do;
   CLUSvads [1] + ( genre_HistDocument1 - 1.60537387799739 )**2;
   CLUSvads [2] + ( genre_HistDocument1 - -0.31132617810331 )**2;
   CLUSvads [3] + ( genre_HistDocument1 - 0.01986215180035 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Horror0 ) then do;
   CLUSvads [1] + ( genre_Horror0 - 0.24215225943668 )**2;
   CLUSvads [2] + ( genre_Horror0 - 0.02833963218366 )**2;
   CLUSvads [3] + ( genre_Horror0 - -0.00197788132947 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Horror1 ) then do;
   CLUSvads [1] + ( genre_Horror1 - -0.24215225943668 )**2;
   CLUSvads [2] + ( genre_Horror1 - -0.02833963218366 )**2;
   CLUSvads [3] + ( genre_Horror1 - 0.00197788132947 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_MusicalPerfarts0 ) then do;
   CLUSvads [1] + ( genre_MusicalPerfarts0 - -3.96823282492381 )**2;
   CLUSvads [2] + ( genre_MusicalPerfarts0 - -0.03673373173265 )**2;
   CLUSvads [3] + ( genre_MusicalPerfarts0 - 0.00416230372552 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( genre_MusicalPerfarts1 ) then do;
   CLUSvads [1] + ( genre_MusicalPerfarts1 - 3.96823282492381 )**2;
   CLUSvads [2] + ( genre_MusicalPerfarts1 - 0.03673373173265 )**2;
   CLUSvads [3] + ( genre_MusicalPerfarts1 - -0.00416230372552 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Romance0 ) then do;
   CLUSvads [1] + ( genre_Romance0 - 0.19171036082114 )**2;
   CLUSvads [2] + ( genre_Romance0 - 0.08050208235456 )**2;
   CLUSvads [3] + ( genre_Romance0 - -0.00540136692754 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Romance1 ) then do;
   CLUSvads [1] + ( genre_Romance1 - -0.19171036082114 )**2;
   CLUSvads [2] + ( genre_Romance1 - -0.08050208235456 )**2;
   CLUSvads [3] + ( genre_Romance1 - 0.00540136692754 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Sci_fi0 ) then do;
   CLUSvads [1] + ( genre_Sci_fi0 - 0.21363352939747 )**2;
   CLUSvads [2] + ( genre_Sci_fi0 - -0.9023041393562 )**2;
   CLUSvads [3] + ( genre_Sci_fi0 - 0.05950756409159 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Sci_fi1 ) then do;
   CLUSvads [1] + ( genre_Sci_fi1 - -0.21363352939747 )**2;
   CLUSvads [2] + ( genre_Sci_fi1 - 0.9023041393562 )**2;
   CLUSvads [3] + ( genre_Sci_fi1 - -0.05950756409159 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Special_Interest0 ) then do;
   CLUSvads [1] + ( genre_Special_Interest0 - 0.20079923895056 )**2;
   CLUSvads [2] + ( genre_Special_Interest0 - 0.20079923895056 )**2;
   CLUSvads [3] + ( genre_Special_Interest0 - -0.01335148045515 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( genre_Special_Interest1 ) then do;
   CLUSvads [1] + ( genre_Special_Interest1 - -0.20079923895056 )**2;
   CLUSvads [2] + ( genre_Special_Interest1 - -0.20079923895056 )**2;
   CLUSvads [3] + ( genre_Special_Interest1 - 0.01335148045515 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ThrillMysSusp0 ) then do;
   CLUSvads [1] + ( genre_ThrillMysSusp0 - 0.3225224724024 )**2;
   CLUSvads [2] + ( genre_ThrillMysSusp0 - 0.11174879862142 )**2;
   CLUSvads [3] + ( genre_ThrillMysSusp0 - -0.00752256826957 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_ThrillMysSusp1 ) then do;
   CLUSvads [1] + ( genre_ThrillMysSusp1 - -0.3225224724024 )**2;
   CLUSvads [2] + ( genre_ThrillMysSusp1 - -0.11174879862142 )**2;
   CLUSvads [3] + ( genre_ThrillMysSusp1 - 0.00752256826957 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Western0 ) then do;
   CLUSvads [1] + ( genre_Western0 - 0.0574604255507 )**2;
   CLUSvads [2] + ( genre_Western0 - -0.00052323235186 )**2;
   CLUSvads [3] + ( genre_Western0 - 9.4259228264429E-6 )**2;
end;
else _vqmvar + 0.5;
if not missing( genre_Western1 ) then do;
   CLUSvads [1] + ( genre_Western1 - -0.0574604255507 )**2;
   CLUSvads [2] + ( genre_Western1 - 0.00052323235186 )**2;
   CLUSvads [3] + ( genre_Western1 - -9.4259228264284E-6 )**2;
end;
else _vqmvar + 0.5;
_vqnvar = 37 - _vqmvar;
if _vqnvar <= 2.5659119273768E-10 then do;
   _SEGMENT_ = .; Distance = .;
end;
else do;
   _SEGMENT_ = 1; Distance = CLUSvads [1];
   _vqfzdst = Distance * 0.99999999999988; drop _vqfzdst;
   do _vqclus = 2 to 3;
      if CLUSvads [_vqclus] < _vqfzdst then do;
         _SEGMENT_ = _vqclus; Distance = CLUSvads [_vqclus];
         _vqfzdst = Distance * 0.99999999999988;
      end;
   end;
   Distance = sqrt(Distance * (37 / _vqnvar));
end;
CLUSvlex :;

***************************************;
*** End Scoring Code from PROC DMVQ ***;
***************************************;
*------------------------------------------------------------*;
* Clus: Creating Segment Label;
*------------------------------------------------------------*;
length _SEGMENT_LABEL_ $80;
label _SEGMENT_LABEL_='Segment Description';
if _SEGMENT_ = 1 then _SEGMENT_LABEL_="Cluster1";
else
if _SEGMENT_ = 2 then _SEGMENT_LABEL_="Cluster2";
else
if _SEGMENT_ = 3 then _SEGMENT_LABEL_="Cluster3";
